const COMPONENTS_VERSION=1;let ItemComponentBuilder=async function(e,t,o){if("string"==typeof e)return e;let n,r=e.type,c=e.Ft||e.j||{};switch(e.Dt&&(r="none"),r){default:let r;if(n=document.createElement("DIV"),n.className="section","string"==typeof e||Array.isArray(e))r=e;else if(r=e.content,e.title){let t=document.createElement("DIV");t.classList.add("section-title","font-subtitle"),t.innerText=e.title,n.append(t)}if("string"==typeof r)n.append(r);else for(content of r)n.append(await ItemComponentBuilder(content,t,o));break;case"quote":n=document.createElement("DIV"),n.className="quote";let a=document.createElement("DIV");a.className="font-header",a.innerHTML=e.content;let s=document.createElement("SPAN");s.className="font-base",s.innerHTML=e.He||"",n.append(a,s);break;case"gallery":n=document.createElement("DIV"),n.className="gallery";let l=[],i=5,u=c.Ht&&c.Ht<=i?c.Ht:e.ge.length<i?e.ge.length:i,f=new Array(u);if(c.Wt){let t=0;for(let o=0;o<e.ge.length;o++){let n=e.ge[o],r=c.Wt.findIndex((e=>e==n.hash));if(-1!=r&&(f[r]=n,n.en=!0,t++),t==c.Wt.length)break}if(f=f.filter((e=>e)),t<u){let o=u-t,n=0;for(;o>0;)e.ge[n].en||(f[u-o]=e.ge[n],o--),n++}}else for(let t=0;t<u;t++)f[t]=e.ge[t];if(e.title&&!c.qt&&e.ge.length>1){n.innerHTML="<div><b class='font-subtitle'>"+e.title+"</b></div>",n.classList.add("show-controls");let t=document.createElement("A");t.innerHTML="<i class='mi mi-Picture'></i><span>Show all</span>",t.className="button",t.href="/"+APP.url.Ie+"/"+o.id+"/"+f[0].hash,t.onclick=function(e){e.preventDefault(),ViewController.navigate(VIEW.Ie,{oe:[o.id,f[0].hash],Te:o})},n.children[0].appendChild(t)}let m=document.createElement("DIV");m.className="list",n.appendChild(m);for(let e=0;e<u;e++){let t=f[e],n=document.createElement("IMG");n.alt=t?.Ft?.alt||"",n.src=t.src,n.className=GLOBAL.loading,m.appendChild(n),l.push(ImageHelper(n,(function(e){e.onclick=function(){ViewController.navigate(VIEW.Ie,{oe:[o.id,t.hash],Te:o})},e.classList.remove(GLOBAL.loading)}),(e=>e.classList.remove(GLOBAL.loading)))),t.Ft.node=n}if(Promise.all(l.map((async e=>await e))),n.classList.add("items-count-"+u),c.alt){let t=document.createElement("span"),o="boolean"==typeof c.alt?e.ge[0].Ft.alt:c.alt;t.innerHTML=o,t.classList.add("img-alt"),n.appendChild(t)}break;case"link":n=document.createElement("A"),n.className="link",n.innerHTML=e.content,n.href=e.href,n.target=e.target;break;case"decoration":case"bold":case"b":case"underline":case"u":case"italic":case"i":case"sup":case"sub":let d;switch(e.style||e.type){case"bold":case"b":d="b";break;case"underline":case"u":d="u";break;case"italic":case"i":d="i";break;case"sup":d="sup";break;case"sub":d="sub";break;default:d="span"}n=document.createElement(d),n.append(await ItemComponentBuilder(e.content));break;case"note":if(n=document.createElement("DIV"),n.classList.add("note"),e.title){let t=document.createElement("B");t.innerText=e.title,n.appendChild(t)}n.append(await ItemComponentBuilder(e.content));break;case"list":let b=e.ordered?"ol":"ul";for(o of(n=document.createElement(b),e.content)){let e=document.createElement("LI");e.append(await ItemComponentBuilder(o)),n.appendChild(e)}break;case"image":n=document.createElement("IMG"),n.alt=e.ge[0].Ft?.alt||"",n.src=e.ge[0].src,n.className=GLOBAL.loading,ImageHelper(n,(e=>e.classList.remove(GLOBAL.loading)),(e=>e.classList.remove(GLOBAL.loading)))}return n.style=e.style,n.fo=e.fo,n.id=e.id,e.node=n,n},ItemStuctureBuilder=function(e,t){Object.assign(e,t),e.ho=new ResourceDictionary([new ResourceGroup([new Resource("/"+ITEM.fileName,"item",null)])]),ComponentConverter(e,e),e.debug&&console.log(e)},ComponentConverter=function(e,t){if("object"!=typeof e)return e;if(Array.isArray(e.content))for(_child of e.content)ComponentConverter(_child,t);let o=e.ge||e.src;o&&ResourceResolver(o,e,t)},ResourceResolver=function(e,t,o){let n=new ResourceGroup;if(Array.isArray(e))for(_res of e)n.co(ResourcesConverter(_res,t,o));else n.co(ResourcesConverter(e,t,o));let r=o.ho.wo(n);t.ge=o.ho[r].ge,t.zt=r},ResourcesConverter=function(e,t,o){let n=[],r=o.W,c=ITEM.W+r+ITEM.t+e.src;switch(e.type){case"image":n.push(new Resource(c,"image",CREATE_HASH(c+t.id),e.Ft));break;case"group":let o=ItemController.Ge(e.id);if(!o)return e;o.content.forEach((e=>{e.j?.Kt||n.push(new Resource(ITEM.W+e.W+e.P.B,"image",CREATE_HASH(ITEM.W+e.W+e.P.B+t.id),t.Ft))}));break;default:n.push(e)}return n};