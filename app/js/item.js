const COMPONENTS_VERSION=1;let ItemComponentBuilder=async function(e,t,r){if("string"==typeof e)return e;let n,s=e.type,o=e.arguments||{};switch(e.dontRender&&(s="none"),s){default:if(n=document.createElement("DIV"),n.classList.add("section"),e.title){let t=document.createElement("DIV");t.className="section-title font-subtitle",t.innerText=e.title,n.append(t)}"string"==typeof e.content?n.append(e.content):e.content.forEach((async e=>n.append(await ItemComponentBuilder(e,t,r))));break;case"quote":n=document.createElement("DIV"),n.className="quote";let s=document.createElement("DIV");s.className="font-header",s.innerHTML=e.content;let a=document.createElement("SPAN");a.className="font-base",a.innerHTML=e.author,n.appendChild(s),n.appendChild(a);break;case"gallery":n=document.createElement("DIV"),n.classList.add("gallery");let l=[],c=5,i=o.imagesCount&&o.imagesCount<=c?o.imagesCount:e.resources.length<c?e.resources.length:c,d=new Array(i);if(o.resourceOrder){let t=0;for(let r=0;r<e.resources.length;r++){let n=e.resources[r],s=o.resourceOrder.findIndex((e=>e==n.hash));if(-1!=s&&(d[s]=n,t++),t==o.resourceOrder.length)break}}else for(let t=0;t<i;t++)d[t]=e.resources[t];if(!o.hideControls&&e.resources.length>1){n.innerHTML="<div><b class='font-subtitle'>"+e.title+"</b></div>",n.classList.add("show-controls");let t=document.createElement("A");t.innerHTML="<i class='mi mi-Picture'></i><span>Show all</span>",t.classList.add("button"),t.onclick=function(){ViewController.navigate(VIEW.resource,{routeArg:[r.id,d[0].hash],currentItem:r})},n.children[0].appendChild(t)}let u=document.createElement("DIV");u.classList.add("list"),n.appendChild(u);for(let e=0;e<i;e++){let t=d[e],n=document.createElement("IMG");n.alt=t?.props?.alt||"",n.src=t.src,n.classList.add(GLOBAL.loading),u.appendChild(n),l.push(ImageHelper(n,(function(e){e.onclick=function(){ViewController.navigate(VIEW.resource,{routeArg:[r.id,t.hash],currentItem:r})},e.classList.remove(GLOBAL.loading)}),(function(e){e.classList.remove(GLOBAL.loading)})))}if(Promise.all(l.map((async e=>await e))),n.classList.add("items-count-"+i),e.arguments?.alt){let t=document.createElement("span"),r="boolean"==typeof e.arguments.alt?e.resources[0].props.alt:e.arguments.alt;t.innerHTML=r,t.classList.add("img-alt"),n.appendChild(t)}break;case"link":n=document.createElement("A"),n.classList.add("link"),n.innerHTML=e.content,n.href=e.href,n.target=e.target}return n},ItemBuilder=function(e){let t=e.folder;e.content.map((async function(r,n){if(r.resources){let s=0;for(;s<r.resources.length;){let e=ResourceConverter(r.resources[s],APP.itemFolder+t+APP.resourceFolder,r.id||n);r.resources.splice(s,1,...e),s+=e.length}r.resourceGroupIndex=e.resources.length,e.resources.push(new ResourceGroup(r.resources))}})),e.debug&&console.log(e)},ResourceConverter=function(e,t,r){let n=[];switch(e.type){case"group":ItemController.getGroupById(e.id).content.forEach((t=>{t.arg?.ignoreTileImageInGallery||n.push(new Resource(APP.itemFolder+t.folder+t.tile.image,"image",createHash(APP.itemFolder+t.folder+t.tile.image+r),e.props))}));break;case"image":n.push(new Resource(t+e.src,"image",createHash(t+e.src+r),e.props));break;case"item":let s=ItemController.getItemSnapshotById(e.id);n.push(new Resource(APP.itemFolder+s.folder+s.tile.image,"image",createHash(APP.itemFolder+s.folder+s.tile.image+r),e.props));break;default:n.push(e)}return n};