const COMPONENTS_VERSION=1;let ItemBuilder=function(e){let t=e.W;e.content.map((async function(n,o){if(n.ge){let r=0;for(;r<n.ge.length;){let e=ResourceConverter(n.ge[r],APP.l+t+APP.t,n.id||o);n.ge.splice(r,1,...e),r+=e.length}n.zt=e.ge.length,e.ge.push(new ResourceGroup(n.ge))}})),e.debug&&console.log(e)},ResourceConverter=function(e,t,n){let o=[],r=t=>o.push(new Resource(APP.l+t.W+t.P.B,"image",createHash(APP.l+t.W+t.P.B+n),e.Ft));switch(e.type){case"group":let l=ItemController.Ge(e.id);if(!l)return o;l.content.forEach((e=>{e.j?.Kt||r(e)}));break;case"image":o.push(new Resource(t+e.src,"image",createHash(t+e.src+n),e.Ft));break;case"item":let i=ItemController.Oe(e.id);r(i);break;default:o.push(e)}return o},ItemComponentBuilder=async function(e,t,n){if("string"==typeof e)return e;let o,r=e.type,l=e.arguments||{};switch(e.Dt&&(r="none"),r){default:if(o=document.createElement("DIV"),o.className="section",e.title){let t=document.createElement("DIV");t.className="section-title font-subtitle",t.innerText=e.title,o.append(t)}"string"==typeof e.content?o.append(e.content):e.content.forEach((async e=>o.append(await ItemComponentBuilder(e,t,n))));break;case"quote":o=document.createElement("DIV"),o.className="quote";let r=document.createElement("DIV");r.className="font-header",r.innerHTML=e.content;let i=document.createElement("SPAN");i.className="font-base",i.innerHTML=e.He,o.appendChild(r),o.appendChild(i);break;case"gallery":o=document.createElement("DIV"),o.className="gallery";let c=[],u=5,a=l.Ht&&l.Ht<=u?l.Ht:e.ge.length<u?e.ge.length:u,s=new Array(a);if(l.Wt){let t=0;for(let n=0;n<e.ge.length;n++){let o=e.ge[n],r=l.Wt.findIndex((e=>e==o.hash));if(-1!=r&&(s[r]=o,o.en=!0,t++),t==l.Wt.length)break}if(s=s.filter((e=>e)),t<a){let n=a-t,o=0;for(;n>0;)e.ge[o].en||(s[a-n]=e.ge[o],n--),o++}}else for(let t=0;t<a;t++)s[t]=e.ge[t];if(!l.qt&&e.ge.length>1){o.innerHTML="<div><b class='font-subtitle'>"+e.title+"</b></div>",o.classList.add("show-controls");let t=document.createElement("A");t.innerHTML="<i class='mi mi-Picture'></i><span>Show all</span>",t.className="button",t.href=APP.url.Ie+"/"+n.id+"/"+s[0].hash,t.onclick=function(){ViewController.navigate(VIEW.Ie,{oe:[n.id,s[0].hash],Te:n})},o.children[0].appendChild(t)}let f=document.createElement("DIV");f.className="list",o.appendChild(f);for(let e=0;e<a;e++){let t=s[e],o=document.createElement("IMG");o.alt=t?.Ft?.alt||"",o.src=t.src,o.className=GLOBAL.loading,f.appendChild(o),c.push(ImageHelper(o,(function(e){e.onclick=function(){ViewController.navigate(VIEW.Ie,{oe:[n.id,t.hash],Te:n})},e.classList.remove(GLOBAL.loading)}),(e=>e.classList.remove(GLOBAL.loading))))}if(Promise.all(c.map((async e=>await e))),o.classList.add("items-count-"+a),e.arguments?.alt){let t=document.createElement("span"),n="boolean"==typeof e.arguments.alt?e.ge[0].Ft.alt:e.arguments.alt;t.innerHTML=n,t.classList.add("img-alt"),o.appendChild(t)}break;case"link":o=document.createElement("A"),o.className="link",o.innerHTML=e.content,o.href=e.href,o.target=e.target}return o};